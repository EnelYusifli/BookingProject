@{
	Layout = "~/Views/Shared/AdminLayout.cshtml";
}
@model MessagePageViewModel

<!-- Page main content START -->
<div class="page-content-wrapper p-xxl-4">

	<!-- Title -->
	<div class="row">
		<div class="col-12 mb-4 mb-sm-5">
			<div class="d-sm-flex justify-content-between align-items-center">
				<h1 class="h3 mb-3 mb-sm-0">Received Messages</h1>
			</div>
		</div>
	</div>
	<!-- Guest list START -->
	<div class="card shadow mt-5">
		<!-- Card body START -->
		<div class="card-body">
			<!-- Table head -->
			<div class="bg-light rounded p-3 d-none d-lg-block">
				<div class="row row-cols-7 g-4">
					<div class="col"><h6 class="mb-0">Message</h6></div>
					<div class="col"><h6 class="mb-0">Action</h6></div>
				</div>
			</div>
			@foreach (var item in Model.List)
			{
				<!-- Table data -->
				<div class="row row-cols-xl-7 align-items-lg-center border-bottom g-4 px-2 py-4">

					<!-- Data item -->
					<div class="col">
						<small class="d-block d-lg-none">Message</small>
						<h6 class="mb-0 fw-normal">@item.MessageText</h6>
					</div>

					<!-- Data item -->
					<div class="col">
						<div class="d-flex flex-column gap-2">
							<!-- Reply Button -->
							<a data-toggle="modal" data-target="#replyModal-@item.Id" class="btn btn-sm btn-primary-soft mb-0">Reply</a>
							<!-- Delete Button -->
							<a asp-action="DeleteMessage" asp-route-id="@item.Id" class="btn btn-sm delete-btn btn-danger-soft mb-0">Delete</a>
						</div>
					</div>

				</div>
				<!-- Modal for composing a reply -->
				<div class="modal fade" id="replyModal-@item.Id" tabindex="-1" role="dialog" aria-labelledby="replyModalLabel-@item.Id" aria-hidden="true">
					<div class="modal-dialog" role="document">
						<div class="modal-content">
							<form asp-action="ReplyMessage" method="post" asp-route-id="@item.Id">
								<div class="modal-header">
									<h5 class="modal-title" id="replyModalLabel-@item.Id">Reply to Message</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<input type="hidden" asp-for="Reply.Id" value="@item.Id" />
									<div class="form-group">
										<label for="replyContent">Reply Content</label>
										<textarea class="form-control" id="replyContent" asp-for="Reply.Reply" rows="3"></textarea>
									</div>
									<!-- Add other form fields as needed -->
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
									<button type="submit" class="btn btn-primary" asp-route-id="@item.Id">Send Reply</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			}

		</div>
		<!-- Card body END -->

		<!-- Card footer START -->
		<div class="card-footer pt-0">
			<!-- Pagination and content -->
			<div class="d-sm-flex justify-content-sm-between align-items-sm-center mt-4">
				<!-- Pagination -->
				<div class="row">
					<div class="col-12">
						<nav class="mt-4 d-flex justify-content-center" aria-label="navigation">
							<ul class="pagination pagination-primary-soft d-inline-block d-md-flex rounded mb-0">
								<li class="page-item @(Model.List.HasPrev ? "" : "disabled") mb-0">
									<a class="page-link" asp-action="Messages" asp-route-page="@(Model.List.CurrentPage - 1)" tabindex="-1">
										<i class="fa-solid fa-angle-left"></i>
									</a>
								</li>
								@for (int i = 1; i <= Model.List.TotalPageCount; i++)
								{
									<li class="page-item @(Model.List.CurrentPage == i ? "active" : "") mb-0">
										<a class="page-link" asp-action="Messages" asp-route-page="@i">@i</a>
									</li>
								}
								<li class="page-item @(Model.List.HasNext ? "" : "disabled") mb-0">
									<a class="page-link" asp-action="Messages" asp-route-page="@(Model.List.CurrentPage + 1)">
										<i class="fa-solid fa-angle-right"></i>
									</a>
								</li>
							</ul>

						</nav>
					</div>
				</div>
			</div>
		</div>
		<!-- Card footer END -->
	</div>
	<!-- Guest list END -->
</div>
<!-- Page main content END -->
